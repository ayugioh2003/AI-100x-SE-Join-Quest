import{d as O,c as R,u as K,R as J,o as g,a as U,r as D,b as y,e as v,n as k,t as $,f as Q,g as X,h as s,i as E,j as Y,F as S,k as P,w as z,l as L,m as Z,p as F,q as ee,s as te,v as se,x as oe}from"./vue-BtTGjxM2.js";import{C as H,a as A,P as M}from"./gameLogic-DxLZLSGi.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))c(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const h of a.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&c(h)}).observe(document,{childList:!0,subtree:!0});function l(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function c(n){if(n.ep)return;n.ep=!0;const a=l(n);fetch(n.href,a)}})();const ne=O({__name:"App",setup(p){return(t,l)=>(g(),R(K(J)))}}),V=U("chess",()=>{const p=D(new H),t=D(null),l=r=>{t.value=r},c=()=>{t.value=null},n=(r,b)=>p.value.makeMove(r,b),a=()=>{p.value=new H,t.value=null},h=y(()=>p.value.getCurrentPlayer()),f=y(()=>p.value.isGameOver()),_=r=>{const b=p.value.getBoard().getPieceAt(r);return b?{type:b.type,color:b.color,position:b.position}:null},m=r=>{const b=p.value.getBoard().getPieceAt(r);return b?b.getPossibleMoves(p.value.getBoard()):[]},C=y(()=>p.value.getBoard()),x=y(()=>p.value.getWinner());return{selectedPosition:t,selectPosition:l,clearSelection:c,makeMove:n,resetGame:a,currentPlayer:h,isGameOver:f,getPieceAt:_,getBoard:C,getWinner:x,getValidMoves:m}}),q=O({__name:"ChessPiece",props:{piece:{},position:{}},setup(p){const t=p,l=V(),c=D(!1),n=y(()=>({[A.RED]:{GENERAL:"帥",GUARD:"仕",ROOK:"車",HORSE:"馬",CANNON:"炮",ELEPHANT:"相",SOLDIER:"兵"},[A.BLACK]:{GENERAL:"將",GUARD:"士",ROOK:"車",HORSE:"馬",CANNON:"砲",ELEPHANT:"象",SOLDIER:"卒"}})[t.piece.color][t.piece.type]),a=y(()=>t.piece.color===l.currentPlayer),h=y(()=>t.piece.color===A.RED?"bg-gradient-to-br from-red-500 to-red-700 text-white border-red-800 shadow-red-300 hover:from-red-400 hover:to-red-600":"bg-gradient-to-br from-gray-800 to-gray-900 text-white border-gray-700 shadow-gray-500 hover:from-gray-700 hover:to-gray-800"),f=m=>{if(t.piece.color!==l.currentPlayer){m.preventDefault();return}c.value=!0,m.dataTransfer&&(m.dataTransfer.setData("application/json",JSON.stringify({from:t.position,piece:t.piece})),m.dataTransfer.effectAllowed="move")},_=()=>{c.value=!1};return(m,C)=>(g(),v("div",{class:k(["w-10 h-10 rounded-full flex items-center justify-center text-lg font-bold border-3 shadow-lg cursor-pointer select-none transform transition-all duration-300 ease-in-out hover:scale-105 hover:shadow-xl active:scale-95",[h.value,{"z-50 scale-110 shadow-2xl ring-4 ring-opacity-50":c.value,"animate-pulse":a.value&&!c.value,"hover:shadow-2xl hover:rotate-3":!c.value}]]),draggable:"true",onDragstart:f,onDragend:_},$(n.value),35))}});class re{audioContext=null;sounds=new Map;enabled=!0;constructor(){this.initAudioContext()}initAudioContext(){try{this.audioContext=new(window.AudioContext||window.webkitAudioContext)}catch(t){console.warn("Web Audio API not supported:",t)}}createSound(t,l,c="sine"){if(!(!this.audioContext||!this.enabled))try{const n=this.audioContext.createOscillator(),a=this.audioContext.createGain();n.connect(a),a.connect(this.audioContext.destination),n.frequency.setValueAtTime(t,this.audioContext.currentTime),n.type=c,a.gain.setValueAtTime(0,this.audioContext.currentTime),a.gain.linearRampToValueAtTime(.1,this.audioContext.currentTime+.01),a.gain.exponentialRampToValueAtTime(.01,this.audioContext.currentTime+l),n.start(this.audioContext.currentTime),n.stop(this.audioContext.currentTime+l)}catch(n){console.warn("Error playing sound:",n)}}playMoveSound(){this.createSound(800,.1,"square")}playCaptureSound(){this.createSound(400,.2,"triangle")}playInvalidMoveSound(){this.createSound(200,.3,"sawtooth")}playWinSound(){[523.25,659.25,783.99,1046.5].forEach((l,c)=>{setTimeout(()=>{this.createSound(l,.4,"sine")},c*150)})}playSelectSound(){this.createSound(1e3,.05,"sine")}setEnabled(t){this.enabled=t}isEnabled(){return this.enabled}async resumeAudioContext(){if(this.audioContext&&this.audioContext.state==="suspended")try{await this.audioContext.resume()}catch(t){console.warn("Failed to resume audio context:",t)}}}const w=new re,ae={class:"bg-amber-200 p-3 sm:p-6 rounded-lg shadow-lg mx-auto max-w-fit"},ie={class:"relative bg-amber-100 border-4 border-amber-800 rounded-lg p-2 sm:p-4 mx-auto"},le={class:"absolute inset-0 w-full h-full",viewBox:"0 0 432 528"},ce={stroke:"#8B4513","stroke-width":"2",fill:"none"},ue=["y1","y2"],de={stroke:"#8B4513","stroke-width":"2",fill:"none"},ge=["x1","x2"],pe=["x1","x2"],me=["onClick","onDragover","onDragleave","onDrop"],ve=["onClick","onDragover","onDragleave","onDrop"],fe=O({__name:"ChessBoard",setup(p){const t=V(),l=D(null),c=D(null),n=D(null),a=D(window.innerWidth),h=y(()=>a.value<640),f=()=>{a.value=window.innerWidth};Q(()=>{document.addEventListener("click",()=>{w.resumeAudioContext()},{once:!0}),window.addEventListener("resize",f)}),X(()=>{window.removeEventListener("resize",f)});const _=(u,i)=>{const e=t.selectedPosition;return e?.row===u&&e?.col===i},m=(u,i)=>t.selectedPosition?t.getValidMoves(t.selectedPosition).some(o=>o.row===u&&o.col===i):!1,C=(u,i)=>c.value?.row===u&&c.value?.col===i||n.value?.row===u&&n.value?.col===i,x=(u,i)=>t.getPieceAt(new M(u,i)),r=(u,i)=>new M(u,i),b=(u,i)=>{const e=l.value;return e?.row===u&&e?.col===i},N=(u,i,e)=>{e.preventDefault(),l.value=new M(u,i),e.dataTransfer&&(e.dataTransfer.dropEffect="move")},B=(u,i)=>{l.value=null},G=(u,i,e)=>{if(e.preventDefault(),l.value=null,e.dataTransfer)try{const d=JSON.parse(e.dataTransfer.getData("application/json")).from,I=new M(u,i),T=t.makeMove(d,I);T.success?(c.value=d,n.value=I,T.captured?w.playCaptureSound():w.playMoveSound(),T.gameOver&&setTimeout(()=>w.playWinSound(),200)):w.playInvalidMoveSound(),console.log("Move result:",T)}catch(o){console.error("Error parsing drag data:",o)}},W=(u,i)=>{const e=new M(u,i),o=t.getPieceAt(e);if(t.selectedPosition){const d=t.makeMove(t.selectedPosition,e);d.success?(c.value=t.selectedPosition,n.value=e,d.captured?w.playCaptureSound():w.playMoveSound(),d.gameOver&&setTimeout(()=>w.playWinSound(),200)):w.playInvalidMoveSound(),console.log("Move result:",d),t.clearSelection()}else o&&o.color===t.currentPlayer&&(t.selectPosition(e),w.playSelectSound())};return(u,i)=>(g(),v("div",ae,[s("div",ie,[s("div",{class:"relative bg-amber-100 mx-auto transform-gpu",style:E({width:"432px",height:"528px",transform:h.value?"scale(0.75)":"scale(1)",transformOrigin:"center"})},[(g(),v("svg",le,[s("g",ce,[(g(),v(S,null,P(10,e=>s("line",{key:`h-${e}`,x1:24,y1:(e-1)*48+24,x2:408,y2:(e-1)*48+24},null,8,ue)),64))]),s("g",de,[(g(),v(S,null,P(9,e=>s("line",{key:`v-top-${e}`,x1:(e-1)*48+24,y1:24,x2:(e-1)*48+24,y2:216},null,8,ge)),64)),(g(),v(S,null,P(9,e=>s("line",{key:`v-bottom-${e}`,x1:(e-1)*48+24,y1:264,x2:(e-1)*48+24,y2:456},null,8,pe)),64))]),i[0]||(i[0]=Y('<g stroke="#8B4513" stroke-width="2" fill="none"><line x1="168" y1="24" x2="264" y2="120"></line><line x1="264" y1="24" x2="168" y2="120"></line><line x1="168" y1="360" x2="264" y2="456"></line><line x1="264" y1="360" x2="168" y2="456"></line></g>',1))])),i[1]||(i[1]=s("div",{class:"absolute flex items-center justify-center",style:{top:"216px",left:"120px",right:"120px",height:"48px"}},[s("div",{class:"flex gap-8"},[s("span",{class:"text-lg font-bold text-amber-800"},"楚河"),s("span",{class:"text-lg font-bold text-amber-800"},"漢界")])],-1)),(g(),v(S,null,P(5,e=>s("div",{key:`black-row-${e}`,class:"absolute",style:E({top:`${(e-1)*48+8}px`})},[(g(),v(S,null,P(9,o=>s("div",{key:`${e}-${o}`,class:k(["absolute w-8 h-8 flex items-center justify-center cursor-pointer rounded-full transition-all duration-300 ease-in-out",{"bg-yellow-300 bg-opacity-50 ring-2 ring-yellow-500":_(e,o),"bg-green-300 bg-opacity-50 ring-2 ring-green-500":m(e,o),"bg-orange-300 bg-opacity-30 ring-1 ring-orange-400":C(e,o),"hover:bg-gray-200 hover:bg-opacity-30":!_(e,o)&&!m(e,o),"bg-blue-300 bg-opacity-50 ring-2 ring-blue-500":b(e,o)}]),style:E({left:`${(o-1)*48+8}px`}),onClick:d=>W(e,o),onDragover:z(d=>N(e,o,d),["prevent"]),onDragleave:d=>B(),onDrop:d=>G(e,o,d)},[x(e,o)?(g(),R(q,{key:0,piece:x(e,o),position:r(e,o)},null,8,["piece","position"])):L("",!0)],46,me)),64))],4)),64)),(g(),v(S,null,P(5,e=>s("div",{key:`red-row-${e+5}`,class:"absolute",style:E({top:`${(e+4)*48+8}px`})},[(g(),v(S,null,P(9,o=>s("div",{key:`${e+5}-${o}`,class:k(["absolute w-8 h-8 flex items-center justify-center cursor-pointer rounded-full transition-all duration-300 ease-in-out",{"bg-yellow-300 bg-opacity-50 ring-2 ring-yellow-500":_(e+5,o),"bg-green-300 bg-opacity-50 ring-2 ring-green-500":m(e+5,o),"bg-orange-300 bg-opacity-30 ring-1 ring-orange-400":C(e+5,o),"hover:bg-gray-200 hover:bg-opacity-30":!_(e+5,o)&&!m(e+5,o),"bg-blue-300 bg-opacity-50 ring-2 ring-blue-500":b(e+5,o)}]),style:E({left:`${(o-1)*48+8}px`}),onClick:d=>W(e+5,o),onDragover:z(d=>N(e+5,o,d),["prevent"]),onDragleave:d=>B(),onDrop:d=>G(e+5,o,d)},[x(e+5,o)?(g(),R(q,{key:0,piece:x(e+5,o),position:r(e+5,o)},null,8,["piece","position"])):L("",!0)],46,ve)),64))],4)),64))],4)])]))}}),ye={class:"bg-white rounded-lg shadow-lg overflow-hidden"},xe={class:"bg-gradient-to-r from-gray-50 to-gray-100 p-4 text-center border-b"},he={class:"p-6 space-y-4"},be={class:"flex items-center justify-between p-3 bg-gray-50 rounded-lg"},_e={key:0},we={class:"flex items-center justify-between mb-2"},Ce={class:"text-sm font-mono font-bold text-gray-900"},Se={class:"text-xs text-gray-600"},Pe={class:"mt-1 max-h-10 overflow-y-auto"},$e={class:"font-mono"},De={key:1,class:"h-full flex items-center justify-center"},ke={class:"grid grid-cols-2 gap-3 pt-2"},Ae=["disabled"],Ee={class:"border-t bg-gray-50 p-4"},Me={class:"flex items-center justify-between mb-2"},Oe={class:"text-xs text-gray-500"},Te={class:"h-20 overflow-y-auto bg-white border border-gray-200 rounded p-2 text-xs"},Ne={key:0,class:"text-gray-500 text-center"},Re=O({__name:"GamePanel",setup(p){const t=V(),l=y(()=>t.currentPlayer===A.RED?"bg-gradient-to-r from-red-500 to-red-600":"bg-gradient-to-r from-gray-700 to-gray-900"),c=y(()=>t.currentPlayer===A.RED?"紅方":"黑方"),n=y(()=>{if(t.isGameOver){const x=t.getWinner;return x?`${x===A.RED?"紅方":"黑方"}獲勝！`:"遊戲結束"}return"進行中"}),a=y(()=>t.isGameOver?"text-green-700":"text-blue-700"),h=y(()=>0),f=y(()=>t.selectedPosition),_=()=>{t.resetGame()},m=()=>{t.clearSelection()},C=()=>{if(!f.value)return"";const x=t.getValidMoves(f.value);return x.length===0?"無可移動位置":x.map(r=>`(${r.row},${r.col})`).join(", ")};return(x,r)=>(g(),v("div",ye,[s("div",xe,[r[1]||(r[1]=s("h2",{class:"text-lg font-semibold text-gray-700 mb-2"},"當前玩家",-1)),s("div",{class:k(["inline-flex items-center gap-2 px-6 py-3 rounded-full text-white font-bold text-xl shadow-md",l.value])},[r[0]||(r[0]=s("div",{class:"w-3 h-3 bg-white rounded-full animate-pulse"},null,-1)),Z(" "+$(c.value),1)],2)]),s("div",he,[s("div",be,[r[2]||(r[2]=s("span",{class:"text-sm font-medium text-gray-700"},"遊戲狀態",-1)),s("span",{class:k(["text-sm font-bold",a.value])},$(n.value),3)]),s("div",{class:k(["h-24 p-3 bg-blue-50 rounded-lg transition-all duration-300",{"opacity-40":!f.value}])},[f.value?(g(),v("div",_e,[s("div",we,[r[3]||(r[3]=s("span",{class:"text-sm font-medium text-gray-700"},"已選擇",-1)),s("span",Ce," ("+$(f.value.row)+", "+$(f.value.col)+") ",1)]),s("div",Se,[r[4]||(r[4]=s("span",{class:"font-medium"},"可移動至：",-1)),s("div",Pe,[s("span",$e,$(C()),1)])])])):(g(),v("div",De,r[5]||(r[5]=[s("p",{class:"text-sm text-gray-500"},"請選擇棋子",-1)])))],2),s("div",ke,[s("button",{onClick:m,class:"bg-gray-600 hover:bg-gray-700 text-white font-medium py-2.5 px-4 rounded-lg transition-all duration-200 shadow-sm disabled:opacity-40 disabled:cursor-not-allowed disabled:hover:bg-gray-600",disabled:!f.value}," 取消選擇 ",8,Ae),s("button",{onClick:_,class:"bg-blue-600 hover:bg-blue-700 text-white font-medium py-2.5 px-4 rounded-lg transition-all duration-200 shadow-sm"}," 重新開始 ")])]),s("div",Ee,[s("div",Me,[r[6]||(r[6]=s("h3",{class:"text-sm font-semibold text-gray-700"},"棋譜",-1)),s("span",Oe,$(h.value)+" 步",1)]),s("div",Te,[h.value===0?(g(),v("p",Ne,"暫無棋譜")):L("",!0)])])]))}}),Le={class:"min-h-screen bg-gradient-to-br from-amber-50 to-amber-100 flex flex-col"},Ve={class:"flex-1 flex items-center justify-center px-4 py-4 sm:py-8"},je={class:"w-full max-w-6xl"},Be={class:"flex flex-col xl:flex-row gap-4 sm:gap-8 items-center xl:items-start justify-center"},Ge={class:"flex-shrink-0 flex justify-center"},We={class:"w-full xl:w-80 flex-shrink-0 max-w-md xl:max-w-none"},Ie=O({__name:"GameView",setup(p){return(t,l)=>(g(),v("div",Le,[l[0]||(l[0]=s("header",{class:"text-center py-4 sm:py-6"},[s("h1",{class:"text-2xl sm:text-3xl lg:text-4xl font-bold text-gray-800"},"中國象棋")],-1)),s("main",Ve,[s("div",je,[s("div",Be,[s("div",Ge,[F(fe)]),s("div",We,[F(Re)])])])])]))}}),ze=ee({history:te("/AI-100x-SE-Join-Quest/"),routes:[{path:"/",name:"game",component:Ie}]}),j=se(ne);j.use(oe());j.use(ze);j.mount("#app");
